package mqx.dao;

import java.io.FileInputStream;
import java.io.IOException;
import java.sql.*;

import java.util.Properties;

public class DbHelperByMySQL {
	//定义相关属性，只要一份，所以可以定义为静态的
     private static String username,password,url,driverClassName;
     //在静态代码块中初始化
     static {
    	 Properties properties=new Properties();
    	 try {
    		 properties.load(new FileInputStream("src\\jdbc.config"));
    		 username=properties.getProperty("username");
        	 password=properties.getProperty("password");
        	 url=properties.getProperty("url");
        	 driverClassName=properties.getProperty("driverClassName");
             Class.forName(driverClassName);
			 
		} catch (Exception e) {
			
			throw new RuntimeException();
		}
    	
     }
     //获取连接，返回Connection
     public static  Connection getConnection() {
    	 Connection conn=null;
	   try {
		conn=  DriverManager.getConnection(url, username, password);
	} catch (SQLException e) {
		throw new RuntimeException(e);
	}
	   return conn;
	}
     //关闭资源
     public static void close(ResultSet rs, Statement st, Connection conn) {
 		try {
 			if (rs != null)
 				rs.close();
 			if (st != null)
 				st.close();
 			if (conn != null) 
 				conn.close();
 		} catch (SQLException e) {
 			throw new RuntimeException(e);
 		}
 	}
    
}

